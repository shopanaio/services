enum OrderStatus {
  DRAFT
  ACTIVE
  CLOSED
  CANCELLED
}

enum OrderCancelReason {
  CUSTOMER
  FRAUD
  INVENTORY
  STAFF
  OTHER
}

enum OrderEventType {
  ORDER_CREATED
}

union OrderActor = User | ApiKey

type OrderCustomerIdentity {
  customer: Customer
  email: Email
  phone: String
  countryCode: CountryCode
  data: JSON
}

type Order {
  id: ID!
  createdBy: OrderActor!
  status: OrderStatus!
  number: BigInt!
  # Currency
  currencyCode: String!
  # Amounts
  subtotal: BigInt!
  shippingTotal: BigInt
  discountTotal: BigInt
  taxTotal: BigInt
  grandTotal: BigInt!
  # customerId: ID
  customerIdentity: OrderCustomerIdentity!
  customerStatistic: OrderCustomerStatistic!
  adminNote: String
  customerNote: String
  # Order Logs
  events: [OrderEvent!]!
  # Tags
  tags: [Tag!]!
  labels: [Label!]!
  # Order items
  lines: [OrderLine!]!
  createdAt: DateTime!
  updatedAt: DateTime!
  deletedAt: DateTime
}

type OrderLine {
  id: ID!
  quantity: Int!
  unitPrice: Int!
  unitComparePrice: Int!
  discountAmount: Int!
  subtotalAmount: Int!
  taxAmount: Int
  totalAmount: Int!
  purchasableId: ID!
  purchasable: Purchasable!
  createdAt: DateTime!
  updatedAt: DateTime!
}

type OrderDeliveryAddress {
  id: ID!
  address1: String!
  address2: String
  city: String!
  countryCode: CountryCode!
  provinceCode: String
  postalCode: String
  email: Email
  firstName: String
  lastName: String
  data: JSON
}

type OrderCustomerStatistic {
  totalRevenue: Int!
  totalGuestOrders: Int!
  totalAuthorizedOrders: Int!
}

type OrderEvent {
  id: String!
  performedBy: OrderActor!
  eventType: OrderEventType!
  data: JSON
  metadata: JSON
  createdAt: DateTime!
}

input OrderAdminNoteUpdateInput {
  orderId: ID!
  note: String!
}

input OrderCommentAddInput {
  orderId: ID!
  comment: String!
}

input OrderCancelInput {
  orderId: ID!
  comment: String
  reason: OrderCancelReason!
}

input OrderCloseInput {
  orderId: ID!
  comment: String
}

input OrdersInput {
  where: JSON
  order: String
  page: Int
  pageSize: Int
}

type OrdersOutput {
  data: [Order!]!
  meta: CollectionMeta!
}

type OrderQuery {
  orders(input: OrdersInput): OrdersOutput!
  order(id: ID!): Order
}

type OrderMutation {
  orderAdminNoteUpdate(input: OrderAdminNoteUpdateInput!): Boolean!
  orderCommentAdd(input: OrderCommentAddInput!): Boolean!
  orderCancel(input: OrderCancelInput!): Boolean!
  orderClose(input: OrderCloseInput!): Boolean!
}

extend type Query {
  orderQuery: OrderQuery!
}

extend type Mutation {
  orderMutation: OrderMutation!
}
